# mRemoteNG <= v1.77.3.1784-NB Password Dumper ([CVE-2023-32784](https://nvd.nist.gov/vuln/detail/CVE-2023-30367))

The vulnerability was assigned [CVE-2023-30367](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-30367). A fix is still in development. Thanks again to Dimitrij Gorodeckij for his fast response and cooperation!


### What can you do
First, **update to mRemoteNG greater than v1.77.3.1784-NB when a fix has been released**.


1. Use safe configuration encryption passwords. In case of a memory dump an attacker would gain access to configuration files in plaintext but would still have to bruteforce the passwords encryption key.


mRemoteNG Password Dumper is a simple proof-of-concept tool used to dump configuration files from mremoteNG's memory. No code execution on the target system is required, just a memory dump.

Tested with `mRemoteNG 1.77.3.1784-NB` and `mRemoteNG 1.76.20` on Windows (German). Unfortunately, enabling the `Connectionfile encryption` option doesn't help in preventing the attack since they get decrypted at runtime.

Finding was confirmed by Dimitrij Gorodeckij, one of mRemoteNG's developers, [here]([https://sourceforge.net/p/keepass/discussion/329220/thread/f3438e6283/](https://github.com/mRemoteNG/mRemoteNG/issues/726)). I appreciate Dimitrij's fast response. Hopefully it will be fixed soon!

## Setup
1. [Install .NET](https://dotnet.microsoft.com/en-us/download) (most major operating systems supported).
2. Clone the repository: `git clone https://github.com/vdohney/keepass-password-dumper` or download it from GitHub
2. Enter the project directory `mRemoteNG-password-dumper`
3. Open solution with VisualStudio and build using .Net 4.8.1

The easiest way to test this on Windows is to create a process dump in the task manager by right-clicking the mRemoteNG process and selecting "Create dump file".
The dump can be opened in VisualStudio Code. Search then for your your configured connection passwords.

![Usage example](assets/anim.gif)


## Should You Be Worried?

Depends on your threat model. **If your computer is already infected by malware that's running in the background with the privileges of your user, this finding doesn't make your situation much worse.** However, it might be easier for the malware to be stealthy and evade the antivirus, since unlike KeeTheft or KeeFarce, no process injection or other type of code execution is necessary. 

If you have a reasonable suspicion that someone could obtain access to your computer and conduct forensic analysis, this could be bad.

If you use configuration file encryption with a strong password and your system is clean, you should be fine. No one can steal your passwords remotely over the internet with this finding alone. 

## How It Works

mRemoteNG configuration files can be stored in an encrypted state on disk. When mRemoteNG is started the encrypted connection files are read from disk and get decrypted in memory. The connection files are then stored as plain text values in memory of the mRemoteNG process, even before a connection is established.

## Dev

It's a quick POC, so likely not very reliable and robust. Please create a pull request if you happen to find an issue and fix it.

Configuration files are currently hardcoded like this: `(\<Node)(.*)(?=\/>)\/>`

## Acknowledgements to related Projects
- [Python mRemoteNG Password decryptor](https://github.com/kmahyyg/mremoteng-decrypt) by [kmahyyg](https://github.com/kmahyyg) which I modified to add bruteforce functionality.
- [Keepass master password dumper](https://github.com/kmahyyg/mremoteng-decrypt) by [vdohney](https://github.com/vdohney) where I stole this README.md from which I adjusted to my needs.
